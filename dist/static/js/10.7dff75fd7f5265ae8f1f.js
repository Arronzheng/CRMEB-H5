webpackJsonp([10],{"5WGt":function(t,e,s){t.exports=s.p+"static/img/noAddress.d76a1ce.png"},LmZG:function(t,e){},"T+4X":function(t,e){},WkF0:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("X9Ck"),a=s("FWz8"),n={name:"CouponListWindow",props:{value:Boolean,checked:Number,price:{type:[Number,String],default:void 0}},data:function(){return{couponList:[],loaded:!1}},watch:{price:function(t){void 0!==t&&null!=t&&this.getCoupon()}},mounted:function(){},methods:{close:function(){this.$emit("input",!1),this.$emit("close")},getCoupon:function(){var t=this;Object(a.e)(this.price).then(function(e){t.couponList=e.data,t.loaded=!0})},click:function(t){this.$emit("checked",t),this.$emit("input",!1)},couponNo:function(){this.$emit("checked",null),this.$emit("input",!1)}}},o={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"coupon-list-window",class:!0===t.value?"on":""},[s("div",{staticClass:"title"},[t._v("\n      优惠券\n      "),s("span",{staticClass:"iconfont icon-guanbi",on:{click:t.close}})]),t._v(" "),t.couponList.length>0?s("div",[s("div",{staticClass:"coupon-list"},t._l(t.couponList,function(e){return s("div",{key:e.id,staticClass:"item acea-row row-center-wrapper",on:{click:function(s){return t.click(e)}}},[s("div",{staticClass:"money"},[t._v("\n            ￥\n            "),s("span",{staticClass:"num"},[t._v(t._s(e.coupon_price))])]),t._v(" "),s("div",{staticClass:"text"},[s("div",{staticClass:"condition line1"},[t._v(t._s(e.coupon_title))]),t._v(" "),s("div",{staticClass:"data acea-row row-between-wrapper"},[s("div",[t._v("\n                "+t._s(e.start_time?e.start_time+"-":"")+t._s(e.end_time)+"\n              ")]),t._v(" "),t.checked===e.id?s("div",{staticClass:"iconfont icon-xuanzhong1 font-color-red"}):s("div",{staticClass:"iconfont icon-weixuanzhong"})])])])}),0),t._v(" "),s("div",{staticClass:"couponNo bg-color-red",on:{click:t.couponNo}},[t._v("不使用优惠券")])]):t._e(),t._v(" "),!t.couponList.length&&t.loaded?s("div",[t._m(0)]):t._e()]),t._v(" "),s("div",{staticClass:"mask",attrs:{hidden:!1===t.value},on:{touchmove:function(t){t.preventDefault()},click:t.close}})])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"pictrue"},[e("img",{staticClass:"image",attrs:{src:s("k/k8")}})])}]};var r=s("C7Lr")(n,o,!1,function(t){s("T+4X")},"data-v-4814e256",null).exports,c=s("vMJZ"),d={name:"AddressWindow",props:{value:Boolean,checked:Number},data:function(){return{addressList:[],current:0,cartId:0,pinkId:0,couponId:0}},mounted:function(){},methods:{getAddressList:function(){var t=this;Object(c.i)().then(function(e){t.addressList=e.data})},closeAddress:function(){this.$emit("input",!1)},goAddressPages:function(){this.$router.push({path:"/user/add_address"}),this.$emit("redirect")},tapAddress:function(t){this.$emit("checked",this.addressList[t]),this.$emit("input",!1)}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"address-window",class:!0===t.value?"on":""},[i("div",{staticClass:"title"},[t._v("\n      选择地址"),i("span",{staticClass:"iconfont icon-guanbi",on:{click:t.closeAddress}})]),t._v(" "),t.addressList.length?i("div",{staticClass:"list"},t._l(t.addressList,function(e,s){return i("div",{key:s,staticClass:"item acea-row row-between-wrapper",class:e.id===t.checked?"font-color-red":"",on:{click:function(e){return t.tapAddress(s)}}},[i("span",{staticClass:"iconfont icon-ditu",class:e.id===t.checked?"font-color-red":""}),t._v(" "),i("div",{staticClass:"addressTxt"},[i("div",{staticClass:"name",class:e.id===t.checked?"font-color-red":""},[t._v("\n            "+t._s(e.real_name)),i("span",{staticClass:"phone"},[t._v(t._s(e.phone))])]),t._v(" "),i("div",{staticClass:"line1"},[t._v("\n            "+t._s(e.province)+t._s(e.city)+t._s(e.district)+t._s(e.detail)+"\n          ")])]),t._v(" "),i("span",{staticClass:"iconfont icon-complete",class:e.id===t.checked?"font-color-red":""})])}),0):t._e(),t._v(" "),t.addressList.length<1?i("div",{staticClass:"pictrue"},[i("img",{staticClass:"image",attrs:{src:s("5WGt")}})]):t._e(),t._v(" "),i("div",{staticClass:"addressBnt bg-color-red",on:{click:t.goAddressPages}},[t._v("\n      新加地址\n    ")])]),t._v(" "),i("div",{staticClass:"mask",attrs:{hidden:!1===t.value},on:{touchmove:function(t){t.preventDefault()},click:t.closeAddress}})])},staticRenderFns:[]},u=s("C7Lr")(d,l,!1,null,null,null).exports,p=s("T726"),v=s("0xDb"),_="OrderSubmission",f=Object(v.d)(),h={name:_,components:{OrderGoods:i.a,CouponListWindow:r,AddressWindow:u},props:{},data:function(){return{offlinePayStatus:2,from:f?"weixin":"weixinh5",deduction:!0,isWeixin:f,pinkId:0,active:f?"weixin":"yue",showCoupon:!1,showAddress:!1,addressInfo:{},couponId:0,orderGroupInfo:{priceGroup:{}},usableCoupon:{},addressLoaded:!1,useIntegral:!1,orderPrice:{pay_price:"计算中"},mark:"",system_store:{},shipping_type:0,contacts:"",contactsTel:"",store_self_mention:0,userInfo:{}}},watch:{useIntegral:function(){this.computedPrice()},$route:function(t){t.name===_&&(this.getUserInfo(),this.getCartInfo())},shipping_type:function(){this.computedPrice()}},mounted:function(){this.getUserInfo(),this.getCartInfo(),void 0!==this.$route.query.pinkid&&(this.pinkId=this.$route.query.pinkid)},methods:{getUserInfo:function(){var t=this;Object(c.J)().then(function(e){t.userInfo=e.data}).catch(function(){})},addressType:function(t){if(t&&!this.system_store.id)return this.$dialog.error("暂无门店信息，您无法选择到店自提！");this.shipping_type=t},computedPrice:function(){var t=this,e=this.shipping_type;Object(a.k)(this.orderGroupInfo.orderKey,{addressId:this.addressInfo.id,useIntegral:this.useIntegral?1:0,couponId:this.usableCoupon.id||0,shipping_type:parseInt(e)+1}).then(function(e){var s=e.data;"EXTEND_ORDER"===s.status?t.$router.replace({path:"/order/detail/"+s.result.orderId}):t.orderPrice=s.result})},getCartInfo:function(){var t=this,e=this.$route.params.id;if(!e)return this.$dialog.error("参数有误"),this.$router.go(-1);Object(a.l)(e).then(function(e){t.offlinePayStatus=e.data.offline_pay_status,t.orderGroupInfo=e.data,t.deduction=e.data.deduction,t.usableCoupon=e.data.usableCoupon||{},t.addressInfo=e.data.addressInfo||{},t.system_store=e.data.system_store||{},t.store_self_mention=e.data.store_self_mention,t.computedPrice()}).catch(function(){t.$dialog.error("加载订单数据失败")})},addressTap:function(){this.showAddress=!0,this.addressLoaded||(this.addressLoaded=!0,this.$refs.mychild.getAddressList())},addressRedirect:function(){this.addressLoaded=!1,this.showAddress=!1},couponTap:function(){this.showCoupon=!0},changeCoupon:function(t){this.usableCoupon=t||{coupon_title:"不使用优惠券",id:0},this.computedPrice()},payItem:function(t){this.active=t},changeAddress:function(t){this.addressInfo=t},createOrder:function(){var t=this,e=this.shipping_type;if(!this.active)return this.$dialog.toast({mes:"请选择支付方式"});if(!this.addressInfo.id&&!this.shipping_type)return this.$dialog.toast({mes:"请选择收货地址"});if(this.shipping_type){if((""===this.contacts||""===this.contactsTel)&&this.shipping_type)return this.$dialog.toast({mes:"请填写联系人或联系人电话"});if(!/^1(3|4|5|7|8|9|6)\d{9}$/.test(this.contactsTel))return this.$dialog.toast({mes:"请填写正确的手机号"});if(!/^[\u4e00-\u9fa5\w]{2,16}$/.test(this.contacts))return this.$dialog.toast({mes:"请填写您的真实姓名"})}this.$dialog.loading.open("生成订单中"),Object(a.b)(this.orderGroupInfo.orderKey,{real_name:this.contacts,phone:this.contactsTel,addressId:this.addressInfo.id,useIntegral:this.useIntegral?1:0,couponId:this.usableCoupon.id||0,payType:this.active,pinkId:this.pinkId,seckill_id:this.orderGroupInfo.seckill_id,combinationId:this.orderGroupInfo.combination_id,bargainId:this.orderGroupInfo.bargain_id,from:this.from,mark:this.mark||"",shipping_type:parseInt(e)+1}).then(function(e){t.$dialog.loading.close();var s=e.data,i="/order/status/"+s.result.orderId;switch(s.status){case"ORDER_EXIST":case"EXTEND_ORDER":case"PAY_DEFICIENCY":case"PAY_ERROR":t.$dialog.toast({mes:e.msg}),t.$router.replace({path:i+"/0?msg="+e.msg});break;case"SUCCESS":t.$dialog.success(e.msg),t.$router.replace({path:i+"/1"});break;case"WECHAT_H5_PAY":t.$router.replace({path:i+"/2"}),setTimeout(function(){location.href=s.result.jsConfig.mweb_url},100);break;case"WECHAT_PAY":Object(p.pay)(s.result.jsConfig).finally(function(){t.$router.replace({path:i+"/4"})})}}).catch(function(e){console.log(e),t.$dialog.loading.close(),t.$dialog.error(e.msg||"创建订单失败")})}}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"order-submission"},[s("div",{staticClass:"allAddress",style:t.store_self_mention?"":"padding-top: 0.2rem"},[s("div",{staticClass:"nav acea-row"},[t.store_self_mention?s("div",{staticClass:"item font-color-red",class:0===t.shipping_type?"on":"on2",on:{click:function(e){return t.addressType(0)}}}):t._e(),t._v(" "),t.store_self_mention?s("div",{staticClass:"item font-color-red",class:1===t.shipping_type?"on":"on2",on:{click:function(e){return t.addressType(1)}}}):t._e()]),t._v(" "),0===t.shipping_type?s("div",{staticClass:"address acea-row row-between-wrapper",on:{click:t.addressTap}},[t.addressInfo.real_name?s("div",{staticClass:"addressCon"},[s("div",{staticClass:"name"},[t._v("\n          "+t._s(t.addressInfo.real_name)+"\n          "),s("span",{staticClass:"phone"},[t._v(t._s(t.addressInfo.phone))])]),t._v(" "),s("div",[t.addressInfo.is_default?s("span",{staticClass:"default font-color-red"},[t._v("[默认]")]):t._e(),t._v("\n          "+t._s(t.addressInfo.province)+t._s(t.addressInfo.city)+t._s(t.addressInfo.district)+t._s(t.addressInfo.detail)+"\n        ")])]):s("div",{staticClass:"addressCon"},[s("div",{staticClass:"setaddress"},[t._v("设置收货地址")])]),t._v(" "),s("div",{staticClass:"iconfont icon-jiantou"})]):s("div",{staticClass:"address acea-row row-between-wrapper"},[s("div",{staticClass:"addressCon"},[s("div",{staticClass:"name"},[t._v("\n          "+t._s(t.system_store.name)+"\n          "),s("span",{staticClass:"phone"},[t._v(t._s(t.system_store.phone))])]),t._v(" "),s("div",[t._v("\n          "+t._s(t.system_store._detailed_address)+"\n        ")])])]),t._v(" "),t._m(0)]),t._v(" "),s("OrderGoods",{attrs:{evaluate:0,cartInfo:t.orderGroupInfo.cartInfo}}),t._v(" "),s("div",{staticClass:"wrapper"},[!1===t.deduction?s("div",{staticClass:"item acea-row row-between-wrapper",on:{click:t.couponTap}},[s("div",[t._v("优惠券")]),t._v(" "),s("div",{staticClass:"discount"},[t._v("\n        "+t._s(t.usableCoupon.coupon_title||"请选择")+"\n        "),s("span",{staticClass:"iconfont icon-jiantou"})])]):t._e(),t._v(" "),!1===t.deduction?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("积分抵扣")]),t._v(" "),s("div",{staticClass:"discount"},[s("div",{staticClass:"select-btn"},[s("div",{staticClass:"checkbox-wrapper"},[s("label",{staticClass:"well-check"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.useIntegral,expression:"useIntegral"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.useIntegral)?t._i(t.useIntegral,null)>-1:t.useIntegral},on:{change:function(e){var s=t.useIntegral,i=e.target,a=!!i.checked;if(Array.isArray(s)){var n=t._i(s,null);i.checked?n<0&&(t.useIntegral=s.concat([null])):n>-1&&(t.useIntegral=s.slice(0,n).concat(s.slice(n+1)))}else t.useIntegral=a}}}),t._v(" "),s("i",{staticClass:"icon"}),t._v(" "),s("span",{staticClass:"integral"},[t._v("\n                当前积分\n                "),s("span",{staticClass:"num font-color-red"},[t._v("\n                  "+t._s(t.userInfo.integral||0)+"\n                ")])])])])])])]):t._e(),t._v(" "),t.orderGroupInfo.priceGroup.vipPrice>0&&t.userInfo.vip&&0==t.pinkId&&0==t.orderGroupInfo.bargain_id&&0==t.orderGroupInfo.combination_id&&0==t.orderGroupInfo.seckill_id?s("div",{staticClass:"item acea-row row-between-wrapper"},[t._v("\n      会员优惠\n      "),s("div",{staticClass:"discount"},[t._v("￥"+t._s(t.orderGroupInfo.priceGroup.vipPrice))])]):t._e(),t._v(" "),0===t.shipping_type?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("快递费用")]),t._v(" "),s("div",{staticClass:"discount"},[t._v("\n        "+t._s(t.orderGroupInfo.priceGroup.storePostage>0?t.orderGroupInfo.priceGroup.storePostage:"免运费")+"\n      ")])]):s("div",[s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("联系人")]),t._v(" "),s("div",{staticClass:"discount"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.contacts,expression:"contacts"}],attrs:{type:"text",placeholder:"请填写您的联系姓名"},domProps:{value:t.contacts},on:{input:function(e){e.target.composing||(t.contacts=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("联系电话")]),t._v(" "),s("div",{staticClass:"discount"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.contactsTel,expression:"contactsTel"}],attrs:{type:"text",placeholder:"请填写您的联系电话"},domProps:{value:t.contactsTel},on:{input:function(e){e.target.composing||(t.contactsTel=e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"item"},[s("div",[t._v("备注信息")]),t._v(" "),s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.mark,expression:"mark"}],attrs:{placeholder:"请添加备注（150字以内）"},domProps:{value:t.mark},on:{input:function(e){e.target.composing||(t.mark=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"wrapper"},[s("div",{staticClass:"item"},[s("div",[t._v("支付方式")]),t._v(" "),s("div",{staticClass:"list"},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isWeixin,expression:"isWeixin"}],staticClass:"payItem acea-row row-middle",class:"weixin"===t.active?"on":"",on:{click:function(e){return t.payItem("weixin")}}},[s("div",{staticClass:"name acea-row row-center-wrapper"},[s("div",{staticClass:"iconfont icon-weixin2",class:"weixin"===t.active?"bounceIn":""}),t._v("\n            微信支付\n          ")]),t._v(" "),s("div",{staticClass:"tip"},[t._v("微信快捷支付")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isWeixin,expression:"!isWeixin"}],staticClass:"payItem acea-row row-middle",class:"weixin"===t.active?"on":"",on:{click:function(e){return t.payItem("weixin")}}},[s("div",{staticClass:"name acea-row row-center-wrapper"},[s("div",{staticClass:"iconfont icon-weixin2",class:"weixin"===t.active?"bounceIn":""}),t._v("\n            微信支付\n          ")]),t._v(" "),s("div",{staticClass:"tip"},[t._v("微信快捷支付")])]),t._v(" "),s("div",{staticClass:"payItem acea-row row-middle",class:"yue"===t.active?"on":"",on:{click:function(e){return t.payItem("yue")}}},[s("div",{staticClass:"name acea-row row-center-wrapper"},[s("div",{staticClass:"iconfont icon-icon-test",class:"yue"===t.active?"bounceIn":""}),t._v("\n            余额支付\n          ")]),t._v(" "),s("div",{staticClass:"tip"},[t._v("可用余额："+t._s(t.userInfo.now_money||0))])]),t._v(" "),1===t.offlinePayStatus&&!1===t.deduction?s("div",{staticClass:"payItem acea-row row-middle",class:"offline"===t.active?"on":"",on:{click:function(e){return t.payItem("offline")}}},[s("div",{staticClass:"name acea-row row-center-wrapper"},[s("div",{staticClass:"iconfont icon-yinhangqia",class:"offline"===t.active?"bounceIn":""}),t._v("\n            线下支付\n          ")]),t._v(" "),s("div",{staticClass:"tip"},[t._v("线下方便支付")])]):t._e()])])]),t._v(" "),s("div",{staticClass:"moneyList"},[void 0!==t.orderPrice.total_price?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("商品总价：")]),t._v(" "),s("div",{staticClass:"money"},[t._v("￥"+t._s(t.orderPrice.total_price))])]):t._e(),t._v(" "),t.orderPrice.pay_postage>0?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("运费：")]),t._v(" "),s("div",{staticClass:"money"},[t._v("￥"+t._s(t.orderPrice.pay_postage))])]):t._e(),t._v(" "),t.orderPrice.coupon_price>0?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("优惠券抵扣：")]),t._v(" "),s("div",{staticClass:"money"},[t._v("-￥"+t._s(t.orderPrice.coupon_price))])]):t._e(),t._v(" "),t.orderPrice.deduction_price>0?s("div",{staticClass:"item acea-row row-between-wrapper"},[s("div",[t._v("积分抵扣：")]),t._v(" "),s("div",{staticClass:"money"},[t._v("-￥"+t._s(t.orderPrice.deduction_price))])]):t._e()]),t._v(" "),s("div",{staticStyle:{height:"1.2rem"}}),t._v(" "),s("div",{staticClass:"footer acea-row row-between-wrapper"},[s("div",[t._v("\n      合计:\n      "),s("span",{staticClass:"font-color-red"},[t._v("￥"+t._s(t.orderPrice.pay_price))])]),t._v(" "),s("div",{staticClass:"settlement",on:{click:t.createOrder}},[t._v("立即结算")])]),t._v(" "),s("CouponListWindow",{attrs:{price:t.orderPrice.total_price,checked:t.usableCoupon.id},on:{couponchange:function(e){return t.changecoupon(e)},checked:t.changeCoupon},model:{value:t.showCoupon,callback:function(e){t.showCoupon=e},expression:"showCoupon"}}),t._v(" "),s("AddressWindow",{ref:"mychild",attrs:{checked:t.addressInfo.id},on:{checked:t.changeAddress,redirect:t.addressRedirect},model:{value:t.showAddress,callback:function(e){t.showAddress=e},expression:"showAddress"}})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"line"},[e("img",{attrs:{src:s("BPO3")}})])}]};var C=s("C7Lr")(h,m,!1,function(t){s("LmZG")},"data-v-2f6e999c",null);e.default=C.exports},X9Ck:function(t,e,s){"use strict";var i={name:"OrderGoods",props:{evaluate:Number,cartInfo:{type:Array,default:function(){return[]}}},data:function(){return{}},mounted:function(){},methods:{}},a={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"orderGoods"},[s("div",{staticClass:"total"},[t._v("共"+t._s(t.cartInfo.length)+"件商品")]),t._v(" "),s("div",{staticClass:"goodWrapper"},t._l(t.cartInfo,function(e){return s("div",{key:e.id,staticClass:"item acea-row row-between-wrapper"},[s("div",{staticClass:"pictrue"},[s("img",{staticClass:"image",attrs:{src:e.productInfo.image}})]),t._v(" "),s("div",{staticClass:"text"},[s("div",{staticClass:"acea-row row-between-wrapper"},[s("div",{staticClass:"name line1"},[t._v(t._s(e.productInfo.store_name))]),t._v(" "),s("div",{staticClass:"num"},[t._v("x "+t._s(e.cart_num))])]),t._v(" "),e.productInfo.attrInfo?s("div",{staticClass:"attr line1"},[t._v("\n          "+t._s(e.productInfo.attrInfo.suk)+"\n        ")]):t._e(),t._v(" "),s("div",{staticClass:"money font-color-red"},[t._v("￥"+t._s(e.truePrice))]),t._v(" "),3===t.evaluate?s("div",{staticClass:"evaluate",on:{click:function(s){return t.$router.push({path:"/goods_evaluate/"+e.unique})}}},[t._v("\n          评价\n        ")]):t._e()])])}),0)])},staticRenderFns:[]},n=s("C7Lr")(i,a,!1,null,null,null);e.a=n.exports}});
//# sourceMappingURL=10.7dff75fd7f5265ae8f1f.js.map